/** because "dashing" implies speed */
type Dasher = 'üí®';

/** representing dancing or grace */
type Dancer = 'üíÉ';

/** a deer, prancing */
type Prancer = 'ü¶å';

/** a star for the dazzling, slightly mischievous Vixen */
type Vixen = 'üåü';

/** for the celestial body that shares its name */
type Comet = '‚òÑÔ∏è';

/** symbolizing love, as Cupid is the god of love */
type Cupid = '‚ù§Ô∏è';

/** representing thunder, as "Donner" means thunder in German */
type Donner = 'üå©Ô∏è';

/** meaning lightning in German, hence the lightning bolt */
type Blitzen = '‚ö°';

/** for his famous red nose */
type Rudolph = 'üî¥';

type Reindeer = Dasher | Dancer | Prancer | Vixen | Comet | Cupid | Donner | Blitzen | Rudolph;

type SUDOKU = Reindeer[][][];
type ROW = Reindeer[][];
type PLAINROW = Reindeer[];

type Validate<S extends SUDOKU> = FlatRows<S> extends infer PlainRows extends PLAINROW[]
  ? ProcessRows<PlainRows> extends true
    ? ProcessRows<Transpose<PlainRows>> extends true
      ? ProcessRows<BoxesToRows<S>> extends true
        ? true
        : false
      : false
    : false
  : false;

type FlatRows<S extends SUDOKU, PlainRows extends PLAINROW[] = []> = S extends [
  infer First extends ROW,
  ...infer Rest extends SUDOKU
]
  ? FlatRows<Rest, [...PlainRows, MyFlatArray<First>]>
  : PlainRows;

type ProcessRows<PlainRows extends PLAINROW[]> = PlainRows extends [
  infer FirstRow extends PLAINROW,
  ...infer RestRows extends PLAINROW[]
]
  ? ValidateRow<FirstRow> extends true
    ? ProcessRows<RestRows>
    : false
  : true;

type ValidateRow<Row extends PLAINROW> = ArrayToObject<Row> extends UnionToObject<Reindeer> ? true : false;

type MyFlatArray<T, F extends Array<any> = []> = T extends [
  infer First extends Array<any>,
  ...infer Rest extends Array<any>
]
  ? MyFlatArray<Rest, [...F, ...First]>
  : F;

type ArrayToObject<T extends any[]> = {
  [K in T[number]]: true;
};

type UnionToObject<T extends string> = {
  [key in T]: true;
};

type Transpose<MATRIX extends any[][]> = MATRIX extends Array<infer ROW>
  ? {
      [K in keyof ROW]: {
        [P in keyof MATRIX]: MATRIX[P][K];
      };
    }
  : never;

type BoxesToRows<S extends SUDOKU> = [
  [...S[0][0], ...S[1][0], ...S[2][0]],
  [...S[0][1], ...S[1][1], ...S[2][1]],
  [...S[0][2], ...S[1][2], ...S[2][2]],
  [...S[3][0], ...S[4][0], ...S[5][0]],
  [...S[3][1], ...S[4][1], ...S[5][1]],
  [...S[3][2], ...S[4][2], ...S[5][2]],
  [...S[6][0], ...S[7][0], ...S[8][0]],
  [...S[6][1], ...S[7][1], ...S[8][1]],
  [...S[6][2], ...S[7][2], ...S[8][2]]
];

/* _____________ Test Cases _____________ */

import { Equal, Expect } from 'type-testing';

type test_sudoku_1_actual = Validate<
  [
    //   ^?
    [['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥']],
    [['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è']],
    [['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å']],
    [['ü¶å', 'üí®', 'üíÉ'], ['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üî¥', 'üå©Ô∏è', 'üåü']],
    [['üå©Ô∏è', 'üî¥', 'üåü'], ['ü¶å', 'üí®', 'üíÉ'], ['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üå©Ô∏è', 'üî¥', 'üåü'], ['ü¶å', 'üí®', 'üíÉ']],
    [['üíÉ', 'ü¶å', 'üí®'], ['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è'], ['üå©Ô∏è', 'üî¥', '‚ö°']],
    [['üî¥', 'üå©Ô∏è', '‚ö°'], ['üíÉ', 'ü¶å', 'üí®'], ['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è']],
    [['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è'], ['üî¥', 'üå©Ô∏è', '‚ö°'], ['üíÉ', 'ü¶å', 'üí®']]
  ]
>;
type test_sudoku_1 = Expect<Equal<test_sudoku_1_actual, true>>;

type test_sudoku_2_actual = Validate<
  [
    //   ^?
    [['üå©Ô∏è', 'üí®', '‚òÑÔ∏è'], ['üåü', 'ü¶å', '‚ö°'], ['‚ù§Ô∏è', 'üî¥', 'üíÉ']],
    [['üåü', '‚ö°', '‚ù§Ô∏è'], ['üî¥', 'üíÉ', '‚òÑÔ∏è'], ['üå©Ô∏è', 'üí®', 'ü¶å']],
    [['üî¥', 'ü¶å', 'üíÉ'], ['üí®', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', '‚òÑÔ∏è']],
    [['‚ù§Ô∏è', '‚òÑÔ∏è', 'üå©Ô∏è'], ['üíÉ', '‚ö°', 'üî¥'], ['üí®', 'ü¶å', 'üåü']],
    [['ü¶å', 'üíÉ', '‚ö°'], ['üå©Ô∏è', 'üåü', 'üí®'], ['üî¥', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['üí®', 'üåü', 'üî¥'], ['ü¶å', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['‚ö°', 'üíÉ', 'üå©Ô∏è']],
    [['‚òÑÔ∏è', 'üî¥', 'üí®'], ['‚ù§Ô∏è', 'üå©Ô∏è', 'ü¶å'], ['üíÉ', 'üåü', '‚ö°']],
    [['üíÉ', '‚ù§Ô∏è', 'ü¶å'], ['‚ö°', 'üî¥', 'üåü'], ['‚òÑÔ∏è', 'üå©Ô∏è', 'üí®']],
    [['‚ö°', 'üå©Ô∏è', 'üåü'], ['‚òÑÔ∏è', 'üí®', 'üíÉ'], ['ü¶å', '‚ù§Ô∏è', 'üî¥']]
  ]
>;
type test_sudoku_2 = Expect<Equal<test_sudoku_2_actual, true>>;

type test_sudoku_3_actual = Validate<
  [
    //   ^?
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['üåü', '‚ö°', 'üí®'], ['‚ù§Ô∏è', 'üíÉ', 'üî¥'], ['‚òÑÔ∏è', 'üå©Ô∏è', 'ü¶å']],
    [['‚òÑÔ∏è', 'üå©Ô∏è', '‚ù§Ô∏è'], ['‚ö°', 'üåü', 'ü¶å'], ['üíÉ', 'üî¥', 'üí®']],
    [['üå©Ô∏è', 'üíÉ', 'üî¥'], ['ü¶å', 'üí®', '‚ö°'], ['üåü', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['‚ù§Ô∏è', '‚òÑÔ∏è', '‚ö°'], ['üíÉ', 'üå©Ô∏è', 'üåü'], ['ü¶å', 'üí®', 'üî¥']],
    [['üí®', 'üåü', 'ü¶å'], ['‚òÑÔ∏è', 'üî¥', '‚ù§Ô∏è'], ['üå©Ô∏è', 'üíÉ', '‚ö°']],
    [['üíÉ', 'üí®', 'üåü'], ['üî¥', 'ü¶å', '‚òÑÔ∏è'], ['‚ù§Ô∏è', '‚ö°', 'üå©Ô∏è']],
    [['üî¥', '‚ù§Ô∏è', '‚òÑÔ∏è'], ['üåü', '‚ö°', 'üå©Ô∏è'], ['üí®', 'ü¶å', 'üíÉ']],
    [['‚ö°', 'ü¶å', 'üå©Ô∏è'], ['üí®', '‚ù§Ô∏è', 'üíÉ'], ['üî¥', 'üåü', '‚òÑÔ∏è']]
  ]
>;
type test_sudoku_3 = Expect<Equal<test_sudoku_3_actual, true>>;

type test_sudoku_4_actual = Validate<
  [
    //   ^?
    [['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥']],
    [['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è']],
    [['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å']],
    [['ü¶å', 'üí®', 'üíÉ'], ['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üî¥', 'üå©Ô∏è', 'üåü']],
    [['üå©Ô∏è', 'üî¥', 'üåü'], ['ü¶å', 'üí®', 'üíÉ'], ['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['‚ö°', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üå©Ô∏è', 'üî¥', 'üåü'], ['ü¶å', 'üí®', 'üíÉ']],
    [['üíÉ', 'ü¶å', 'üí®'], ['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è'], ['‚ö°', 'üî¥', 'üåü']],
    [['üî¥', 'üå©Ô∏è', '‚ö°'], ['üíÉ', 'ü¶å', 'üí®'], ['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è']],
    [['‚ù§Ô∏è', 'üåü', '‚òÑÔ∏è'], ['üî¥', 'üå©Ô∏è', '‚ö°'], ['üíÉ', 'ü¶å', 'üí®']]
  ]
>;
type test_sudoku_4 = Expect<Equal<test_sudoku_4_actual, false>>;

type test_sudoku_5_actual = Validate<
  [
    //   ^?
    [['üå©Ô∏è', 'üí®', '‚òÑÔ∏è'], ['üåü', 'ü¶å', '‚ö°'], ['‚ù§Ô∏è', 'üî¥', 'üíÉ']],
    [['üåü', '‚ö°', '‚ù§Ô∏è'], ['üî¥', 'üíÉ', '‚òÑÔ∏è'], ['üå©Ô∏è', 'üí®', 'ü¶å']],
    [['üî¥', 'ü¶å', 'üíÉ'], ['üí®', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', '‚òÑÔ∏è']],
    [['‚ù§Ô∏è', '‚òÑÔ∏è', 'üå©Ô∏è'], ['üíÉ', '‚ö°', 'üî¥'], ['üí®', 'ü¶å', 'üåü']],
    [['ü¶å', 'üíÉ', '‚ö°'], ['üå©Ô∏è', 'üåü', 'üí®'], ['üî¥', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['üí®', 'üåü', 'üî¥'], ['ü¶å', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['‚ö°', 'üíÉ', 'üå©Ô∏è']],
    [['‚òÑÔ∏è', 'üî¥', 'üí®'], ['‚ù§Ô∏è', 'üíÉ', 'ü¶å'], ['üíÉ', 'üåü', '‚ö°']],
    [['üíÉ', '‚ù§Ô∏è', 'ü¶å'], ['‚ö°', 'üî¥', 'üåü'], ['‚òÑÔ∏è', 'üå©Ô∏è', 'üí®']],
    [['‚ö°', 'üå©Ô∏è', 'üåü'], ['‚òÑÔ∏è', 'üí®', 'üíÉ'], ['ü¶å', '‚ù§Ô∏è', 'üî¥']]
  ]
>;
type test_sudoku_5 = Expect<Equal<test_sudoku_5_actual, false>>;

type test_sudoku_6_actual = Validate<
  [
    //   ^?
    [['‚ö°', 'üî¥', 'üå©Ô∏è'], ['ü¶å', '‚ù§Ô∏è', 'üí®'], ['üí®', 'üåü', '‚òÑÔ∏è']],
    [['‚ù§Ô∏è', 'ü¶å', 'üåü'], ['üí®', 'üåü', 'üî¥'], ['üíÉ', '‚ö°', 'üå©Ô∏è']],
    [['üí®', 'üíÉ', 'üåü'], ['‚òÑÔ∏è', '‚ö°', 'üå©Ô∏è'], ['üî¥', '‚ù§Ô∏è', 'ü¶å']],
    [['ü¶å', '‚ö°', 'üî¥'], ['‚ù§Ô∏è', 'üíÉ', 'üí®'], ['‚òÑÔ∏è', 'üå©Ô∏è', 'üåü']],
    [['üåü', 'üå©Ô∏è', 'üíÉ'], ['‚ö°', 'üî¥', '‚òÑÔ∏è'], ['‚ù§Ô∏è', 'ü¶å', 'üí®']],
    [['‚òÑÔ∏è', 'üí®', '‚ù§Ô∏è'], ['üåü', 'üå©Ô∏è', 'ü¶å'], ['‚ö°', 'üíÉ', 'üî¥']],
    [['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['üíÉ', 'ü¶å', '‚ö°'], ['üåü', 'üî¥', '‚ù§Ô∏è']],
    [['üî¥', '‚ù§Ô∏è', '‚ö°'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üåü'], ['ü¶å', 'üí®', 'üíÉ']],
    [['üíÉ', 'üåü', 'ü¶å'], ['üî¥', 'üí®', '‚ù§Ô∏è'], ['üå©Ô∏è', '‚òÑÔ∏è', '‚ö°']]
  ]
>;
type test_sudoku_6 = Expect<Equal<test_sudoku_6_actual, false>>;

type test_sudoku_7_actual = Validate<
  [
    [['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥']],
    [['üíÉ', 'ü¶å', '‚òÑÔ∏è'], ['‚ù§Ô∏è', 'üå©Ô∏è', 'üåü'], ['‚ö°', 'üî¥', 'üí®']],
    [['ü¶å', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üå©Ô∏è', 'üåü', '‚ö°'], ['üî¥', 'üí®', 'üíÉ']],
    [['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è'], ['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å']],
    [['‚ù§Ô∏è', 'üå©Ô∏è', 'üåü'], ['‚ö°', 'üî¥', 'üí®'], ['üíÉ', 'ü¶å', '‚òÑÔ∏è']],
    [['üå©Ô∏è', 'üåü', '‚ö°'], ['üî¥', 'üí®', 'üíÉ'], ['ü¶å', '‚òÑÔ∏è', '‚ù§Ô∏è']],
    [['üåü', '‚ö°', 'üî¥'], ['üí®', 'üíÉ', 'ü¶å'], ['‚òÑÔ∏è', '‚ù§Ô∏è', 'üå©Ô∏è']],
    [['‚ö°', 'üî¥', 'üí®'], ['üíÉ', 'ü¶å', '‚òÑÔ∏è'], ['‚ù§Ô∏è', 'üå©Ô∏è', 'üåü']],
    [['üî¥', 'üí®', 'üíÉ'], ['ü¶å', '‚òÑÔ∏è', '‚ù§Ô∏è'], ['üå©Ô∏è', 'üåü', '‚ö°']]
  ]
>;

type test_sudoku_7 = Expect<Equal<test_sudoku_7_actual, false>>;

type test_sudoku_8_actual = Validate<
  [
    //   ^?
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']],
    [['ü¶å', 'üî¥', 'üíÉ'], ['üå©Ô∏è', '‚òÑÔ∏è', 'üí®'], ['‚ö°', '‚ù§Ô∏è', 'üåü']]
  ]
>;

type test_sudoku_8 = Expect<Equal<test_sudoku_8_actual, false>>;
